// B04: Implementation is correct (same as PERFECT).
// The bug is in the test file: only happy-path tests.

// (Same correct implementation as PERFECT -- omitted for brevity)
