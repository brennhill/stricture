// B03: Implementation is correct (same as PERFECT).
// The bug is entirely in the tests.

// (Same correct implementation as PERFECT -- omitted for brevity)
