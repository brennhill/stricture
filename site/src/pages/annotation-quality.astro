---
import MainLayout from "../layouts/MainLayout.astro";
---

<MainLayout title="Annotation Quality" description="How to write clear, actionable annotations so Stricture findings stay understandable.">
  <section class="card">
    <p class="kicker">Guide</p>
    <h1>Annotation quality that keeps findings readable.</h1>
    <p class="lead">Better annotations → clearer findings → faster fixes. Use this checklist when tagging fields.</p>
    <p class="muted">Need the full object model and every key? Start with the <a href="/annotations">Annotation Guide + Index</a>.</p>
    <ul>
      <li><strong>Field identity:</strong> auto-inferred from code position (explicit <code>field</code> only when needed).</li>
      <li><strong>Producer:</strong> <code>from ServiceName</code> (the only required field).</li>
      <li><strong>Provenance:</strong> optional <code>contract</code>, <code>scope</code>, <code>provider</code> qualifiers when needed.</li>
      <li><strong>Everything else:</strong> defaulted by Stricture unless you need custom behavior.</li>
    </ul>
  </section>

  <section class="card">
    <h2>Good vs bad examples</h2>
    <ul>
      <li><strong>Type/size</strong>: Bad "number"; Good "uint8, range 0–255, unit=count".</li>
      <li><strong>Enum</strong>: Bad missing cadence; Good lists values and warns PSP adds quarterly.</li>
      <li><strong>Ownership</strong>: Always include owner + escalation in the service registry.</li>
      <li><strong>Service metadata</strong>: In the registry <code>systems[]</code> section, include <code>owner_team</code> and keep <code>runbook_url</code>/<code>doc_root</code> current when available.</li>
      <li><strong>Freshness</strong>: External providers need as-of + max_staleness.</li>
    </ul>
  </section>

  <section class="card">
    <h2>Template</h2>
    <pre><code>{`// strict-source: PaymentsGateway
//   scope: cross_repo
//   contract: git+https://github.com/acme/payments-core//openapi.yaml@v1.4.2`}</code></pre>
    <p class="muted">Defaults fill owner/escalation, merge/transform policy, classification, contract test ID, flow, and note. Service-level runbooks/docs are declared in the registry <code>systems[]</code> section.</p>
  </section>

  <section class="card">
    <h2>When to block vs warn</h2>
    <ul>
      <li><strong>Block</strong>: type narrowing/widening that exceeds consumer limits, enum removals, missing owner/contract for regulated data.</li>
      <li><strong>Warn</strong>: additive enum, docs-only changes, optional fields with owners set.</li>
    </ul>
  </section>
</MainLayout>
